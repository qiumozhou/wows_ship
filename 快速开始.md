# 快速开始指南

## 更新内容（2025-12-23）

✅ **已修复**：程序无法点击"启动游戏"按钮的问题

主要改进：
- 修正了按钮位置（从中央改为右上角）
- 添加了橙色按钮专门检测
- 改进了游戏状态识别逻辑
- 添加了调试模式和详细日志
- 完善了异常处理和错误信息

详细更新内容请查看：`OPTIMIZATION_CHANGELOG.md`

---

## 第一步：测试按钮检测

在运行完整程序前，建议先测试按钮检测是否正常：

### 1. 打开游戏
- 启动战舰世界游戏
- 进入港口界面
- 确保分辨率为 1920x1080
- 确保游戏窗口在最前面

### 2. 运行测试脚本

```bash
python test_button_detection.py
```

### 3. 选择"1"进行实时测试

程序会：
1. 截取当前屏幕
2. 检测橙色"加入战斗"按钮
3. 显示检测结果
4. 保存调试图片到 `debug_output/` 目录

### 4. 查看结果

如果看到：
```
✅ 检测成功！
  按钮中心位置: (730, 25)
```

说明检测正常，可以进行下一步。

如果看到：
```
❌ 检测失败！
```

请查看 `debug_output/` 目录中的图片，根据提示调整参数。

---

## 第二步：运行调试模式

### 1. 确保游戏在港口界面

### 2. 运行调试模式

```bash
python wows_auto_bot.py --debug
```

### 3. 观察程序行为

程序应该：
1. 识别港口界面
2. 选择第一艘战船
3. 点击"加入战斗"按钮
4. 进入游戏加载界面

### 4. 查看调试截图

在 `debug_output/` 目录查看以下文件：
- `state_port_*.png` - 确认是否正确识别港口
- `orange_button_detected_*.png` - 确认按钮位置是否正确
- `after_select_ship_*.png` - 确认战船选择
- `after_join_battle_click_*.png` - 确认点击后的状态

### 5. 查看日志

检查控制台输出或 `wows_auto_bot.log` 文件，确认：
```
检测到港口界面（橙色加入战斗按钮）
选择第 1 艘战船
准备点击加入战斗按钮
检测到橙色加入战斗按钮，位置: (730, 25)
已点击加入战斗按钮
```

---

## 第三步：正常运行

如果调试模式测试通过：

```bash
python wows_auto_bot.py
```

程序会自动循环运行，执行完整的游戏流程。

按 `Ctrl+C` 停止程序。

---

## 常见问题

### Q1: 程序显示"未知状态"

**答**：可能原因：
1. 游戏窗口被遮挡
2. 分辨率不是 1920x1080
3. 游戏界面有弹窗

**解决方法**：
- 确保游戏窗口在最前面
- 设置游戏分辨率为 1920x1080
- 关闭游戏内弹窗

### Q2: 检测不到橙色按钮

**答**：可能原因：
1. 按钮位置发生变化
2. 颜色范围不匹配

**解决方法**：
1. 运行 `test_button_detection.py` 查看检测结果
2. 查看 `debug_output/test_button_region.png`，确认提取的区域是否正确
3. 如果区域不对，修改 `wows_auto_bot.py` 中的 `JOIN_BATTLE_BUTTON_REGION`
4. 如果颜色不对，调整 `ORANGE_LOWER` 和 `ORANGE_UPPER`

### Q3: 点击位置不准确

**答**：运行测试脚本检查：
```bash
python test_button_detection.py
```

查看 `debug_output/test_full_screen.png`，确认红色圆点是否在按钮中心。

如果位置不对，可以手动调整 `click_join_battle()` 方法中的默认坐标。

### Q4: 程序卡在某个状态

**答**：
1. 按 `Ctrl+C` 停止程序
2. 查看日志，确认卡在哪个步骤
3. 查看 `debug_output/` 中最新的截图
4. 根据实际情况调整相应的检测参数

---

## 参数调整指南

如果需要调整参数，编辑 `wows_auto_bot.py`：

### 调整按钮区域

```python
# 在 WowsAutoBot 类中
JOIN_BATTLE_BUTTON_REGION = (650, 0, 850, 50)  # (x1, y1, x2, y2)
```

### 调整橙色范围

```python
# 在 WowsAutoBot 类中
ORANGE_LOWER = np.array([10, 100, 100])  # HSV下限
ORANGE_UPPER = np.array([25, 255, 255])  # HSV上限
```

### 调整战船位置

```python
# 在 select_ship() 方法中
ship_x = 100 + ship_index * 165  # 调整起始位置和间隔
ship_y = 1000                     # 调整Y坐标
```

---

## 获取帮助

如果遇到问题：

1. **查看详细文档**：
   - `OPTIMIZATION_CHANGELOG.md` - 优化详情
   - `测试说明.md` - 详细测试步骤

2. **运行测试工具**：
   ```bash
   python test_button_detection.py
   ```

3. **启用调试模式**：
   ```bash
   python wows_auto_bot.py --debug
   ```

4. **查看日志**：
   - 控制台输出
   - `wows_auto_bot.log` 文件
   - `debug_output/` 目录中的截图

---

## 安全提示

⚠️ **重要**：
1. 本脚本仅供学习和研究使用
2. 使用自动化脚本可能违反游戏服务条款
3. 建议在测试环境或单机模式下使用
4. 使用前请确保了解相关风险

---

## 下一步

程序运行正常后，你可以：
1. 调整游戏操作参数（射击间隔、寻敌间隔等）
2. 优化瞄准逻辑
3. 添加更多自定义功能

祝游戏愉快！🎮⚓

---

**作者**: seven  
**更新时间**: 2025-12-23

